!function() {
    function r() {
        return {
            login: function(e) {
                return n().post({
                    url: "login",
                    payload: e
                });
            },
            register: function(e) {
                return n().post({
                    url: "register",
                    payload: e
                });
            },
            forgot: function(e) {
                return n().post({
                    url: "forgot",
                    payload: e
                });
            }
        };
    }
    function o() {
        return {
            mode: "production",
            apiUrl: window.location.href + "server/",
            cookieVar: "ewallet"
        };
    }
    function t() {
        return {
            render: function(e) {
                $("#render").html(e);
            },
            log: function(e) {
                "production" == o().mode && console.log(e);
            },
            setCookie: function(e) {
                localStorage.setItem(o().cookieVar, e);
            },
            getCookie: function() {
                return localStorage.getItem(o().cookieVar);
            }
        };
    }
    function n() {
        return {
            post: function(e) {
                return $.post(o().apiUrl + e.url, e.payload);
            }
        };
    }
    $(document).on("click", "#login", function(e) {
        e.preventDefault();
        var o = $("#loginView").html();
        t().render(o);
    }), $(document).on("click", "#register", function(e) {
        e.preventDefault();
        var o = $("#registerVIew").html();
        t().render(o);
    }), $(document).on("click", "#forgot", function(e) {
        e.preventDefault();
        var o = $("#forgotView").html();
        t().render(o);
    }), $(document).on("submit", "#login-form", function(e) {
        e.preventDefault();
        var o = {};
        o.email = document.forms.form.email.value, o.password = document.forms.form.password.value;
        var n = JSON.stringify(o);
        r().login(n).then(function(e) {
            t().log(e);
            var o = e.token;
            if (t().setCookie("access_token=" + o), "access_token=undefined" == t().getCookie()) alert("Invalid one"); else {
                var n = $("#dashboardView").html();
                Finch.navigate("dashboard"), t().render(n);
            }
        }, function(e) {
            t().log(e);
        });
    }), $(document).on("submit", "#register-form", function(e) {
        e.preventDefault();
        var o = {};
        o.name = document.forms["register-form"].name.value, o.email = document.forms["register-form"].email.value, 
        o.password = document.forms["register-form"].password.value;
        var n = JSON.stringify(o);
        r().register(n).then(function(e) {
            alert("success");
        }, function(e) {
            t().log(e);
        });
    }), $(document).on("submit", "#forgot-form", function(e) {
        e.preventDefault();
        var o = {};
        o.email = document.forms["forgot-form"].email.value;
        var n = JSON.stringify(o);
        r().forgot(n).then(function(e) {
            var o = $("#token-verify").html();
            t().render(o);
        }, function(e) {
            t().log(e);
        });
    });
}();