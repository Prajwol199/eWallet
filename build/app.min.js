!function() {
    function e() {
        return {
            renderAddCategory: function() {
                var e = $("#addCategoryView").html();
                Finch.navigate("addCategory"), $("#hide").hide(), $(".dashboard").hide(), i().render(e);
            },
            renderEdit: function() {
                var e = JSON.parse(i().getCookie()).category_id;
                if (null == e) Finch.navigate("login"); else {
                    $("#hide").hide();
                    var t = "localhost/eWallet/server/category/editCategoryData/" + e;
                    r().get(t, "editView", "edit");
                }
            },
            rendercategoryData: function() {
                var e = JSON.parse(i().getCookie()).categoryData_id;
                if (null == e) Finch.navigate("dashboard"); else {
                    $("#hide").hide();
                    var t = "localhost/eWallet/server/data/show/" + e;
                    r().get(t, "categoryView", "categoryData");
                }
            },
            rendereditData: function() {
                var e = JSON.parse(i().getCookie()).editData_id;
                if (null == e) Finch.navigate("categoryData"); else {
                    $("#hide").hide(), $(".categoryView").hide();
                    var t = "localhost/eWallet/server/data/showEditData/" + e;
                    r().get(t, "editDataView", "editData");
                }
            }
        };
    }
    function n() {
        return {
            addCategory: function(e) {
                return r().post({
                    url: "category/addCategory/",
                    payload: e
                });
            },
            deleteCategory: function(e) {
                return r().delete({
                    url: "category/deleteCategory/",
                    payload: e
                });
            },
            editCategory: function(e, t) {
                return r().put({
                    url: "category/editCategory/",
                    id: e,
                    title: t,
                    navigate: "dashboard"
                });
            },
            addData: function(e, t) {
                return r().post({
                    url: "data/add/" + t,
                    payload: e
                });
            },
            deleteData: function(e) {
                return r().delete({
                    url: "data/delete/",
                    payload: e
                });
            },
            editData: function(e, t) {
                return r().put({
                    url: "data/edit/",
                    id: e,
                    title: t,
                    navigate: "categoryData"
                });
            }
        };
    }
    function t() {
        return {
            renderForgot: function() {
                var e = $("#forgotView").html();
                Finch.navigate("forgot"), i().render(e);
            },
            renderLogin: function() {
                if (JSON.parse(i().getCookie())) Finch.navigate("dashboard"); else {
                    var e = $("#loginView").html();
                    Finch.navigate("login"), i().render(e);
                }
            },
            renderRegister: function() {
                var e = $("#registerView").html();
                Finch.navigate("register"), i().render(e);
            },
            renderDashboard: function() {
                $("#dashboardView").html();
                var e = JSON.parse(i().getCookie()), t = e.token, a = e.user_id;
                if (null == t) Finch.navigate("login"); else {
                    $("#hide").hide(), $(".addCategoryView").hide();
                    var o = "localhost/eWallet/server/category/user/" + a;
                    r().get(o, "dashboardView", "dashboard");
                }
            }
        };
    }
    function o() {
        return {
            login: function(e) {
                return r().post({
                    url: "user/login",
                    payload: e
                });
            },
            register: function(e) {
                return r().post({
                    url: "user/register",
                    payload: e
                });
            },
            forgot: function(e) {
                return r().post({
                    url: "user/forgot",
                    payload: e
                });
            },
            recover: function(e) {
                return r().post({
                    url: "user/recover",
                    payload: e
                });
            },
            resendToken: function(e) {
                return r().post({
                    url: "user/resendToken",
                    payload: e
                });
            }
        };
    }
    function i() {
        return {
            render: function(e) {
                var t = Handlebars.compile(e), a = t(t);
                $("#render").html(a);
            },
            log: function(e) {
                console.log(e);
            },
            setCookie: function(e) {
                localStorage.setItem("ewallet", e);
            },
            getCookie: function() {
                return localStorage.getItem("ewallet");
            }
        };
    }
    function r() {
        return {
            post: function(e) {
                return $.post("localhost/eWallet/server/" + e.url, e.payload);
            },
            delete: function(e) {
                $.ajax({
                    type: "delete",
                    url: "localhost/eWallet/server/" + e.url + e.payload,
                    success: function(e) {
                        location.reload();
                    },
                    error: function(e) {
                        alert("Error!");
                    }
                });
            },
            put: function(t) {
                $.ajax({
                    type: "put",
                    url: "localhost/eWallet/server/" + t.url + t.id,
                    data: JSON.stringify(t.title),
                    contentType: "application/json",
                    dataType: "json",
                    success: function(e) {
                        $(".editView").hide(), $(".editDataView").hide(), Finch.navigate(t.navigate);
                    },
                    error: function(e) {
                        alert("Error!");
                    }
                });
            },
            get: function(e, o, r) {
                $.ajax({
                    type: "get",
                    url: e,
                    success: function(e) {
                        $(".dashboard").hide();
                        var t = $("#" + o).html();
                        Finch.navigate(r);
                        var a = Handlebars.compile(t);
                        $("body").append(a({
                            item: e
                        }));
                    },
                    error: function(e) {}
                });
            }
        };
    }
    function a(e, t) {
        var a = JSON.parse(i().getCookie());
        a[e] = t;
        var o = JSON.stringify(a);
        i().setCookie(o);
    }
    $(document).on("submit", "#addCategory-form", function(e) {
        e.preventDefault();
        var t = i().getCookie();
        t = JSON.parse(t);
        var a = {};
        a.title = document.forms.addform.title.value, a.user_id = t.user_id;
        var o = JSON.stringify(a);
        n().addCategory(o).then(function(e) {
            Finch.navigate("dashboard"), location.reload();
        }, function(e) {
            i().log(e);
        });
    }), $(document).on("click", ".delete", function(e) {
        e.preventDefault();
        var t = $(this).data("route");
        n().deleteCategory(t);
    }), $(document).on("submit", "#editCategory-form", function(e) {
        e.preventDefault();
        var t = JSON.parse(i().getCookie()).category_id, a = {};
        a.title = $("#title").val(), n().editCategory(t, a);
    }), $(document).on("submit", "#addData", function(e) {
        e.preventDefault();
        var t = i().getCookie(), a = JSON.parse(t).categoryData_id, o = {};
        o.field_name = $("#fieldName").val(), o.description = $("#description").val();
        var r = JSON.stringify(o);
        n().addData(r, a).then(function(e) {
            Finch.navigate("categoryData"), location.reload();
        }, function(e) {
            i().log(e);
        });
    }), $(document).on("click", ".deleteData", function(e) {
        e.preventDefault();
        var t = $(this).data("route");
        n().deleteData(t);
    }), $(document).on("submit", "#editData", function(e) {
        e.preventDefault();
        var t = JSON.parse(i().getCookie()).editData_id, a = {};
        a.field_name = $("[name=fieldName]").val(), a.description = $("[name=description]").val(), 
        n().editData(t, a);
    }), $(document).on("click", "#dashboard", function(e) {
        e.preventDefault(), Finch.navigate("dashboard"), location.reload();
    }), $(document).on("submit", "#login-form", function(e) {
        e.preventDefault();
        var t = {};
        t.email = document.forms.form.email.value, t.password = document.forms.form.password.value;
        var a = JSON.stringify(t);
        o().login(a).then(function(e) {
            i().log(e);
            var t = e.token, a = e.user_id, o = JSON.stringify({
                token: t,
                user_id: a
            });
            i().setCookie(o), null == JSON.parse(i().getCookie()).token ? alert("Invalid one") : ($(".login").hide(), 
            Finch.navigate("dashboard"));
        }, function(e) {
            i().log(e);
        });
    }), $(document).on("submit", "#register-form", function(e) {
        e.preventDefault();
        var t = {};
        t.name = document.forms["register-form"].name.value, t.email = document.forms["register-form"].email.value, 
        t.password = document.forms["register-form"].password.value;
        var a = JSON.stringify(t);
        o().register(a).then(function(e) {
            var t = e.token;
            i().setCookie("access_token=" + t), Finch.navigate("dashboard");
        }, function(e) {
            i().log(e);
        });
    }), $(document).on("submit", "#forgot-form", function(e) {
        e.preventDefault();
        var t = {};
        t.email = document.forms["forgot-form"].email.value, localStore_email = document.forms["forgot-form"].email.value;
        var a = JSON.stringify(t);
        o().forgot(a).then(function(e) {
            i().setCookie(localStore_email);
            var t = $("#token-verify").html();
            i().render(t);
        }, function(e) {
            i().log(e);
        });
    }), $(document).on("submit", "#recover-form", function(e) {
        e.preventDefault();
        var t = {};
        t.email = i().getCookie(), t.token = document.forms["recover-form"].token.value, 
        t.password = document.forms["recover-form"].password.value;
        var a = JSON.stringify(t);
        o().recover(a).then(function(e) {
            window.localStorage.clear(), Finch.navigate("login");
        }, function(e) {
            alert("Error");
        });
    }), $(document).on("click", "#resend-token", function(e) {
        e.preventDefault();
        var t = {};
        t.email = i().getCookie();
        var a = JSON.stringify(t);
        o().resendToken(a).then(function(e) {
            alert("Token send successfulluy");
        }, function(e) {
            alert("Error");
        });
    }), $(document).on("click", "#logout", function(e) {
        e.preventDefault(), window.localStorage.clear(), Finch.navigate("login"), location.reload();
    }), Finch.route("addCategory/", function() {
        e().renderAddCategory();
    }), Finch.route("edit", function() {
        e().renderEdit();
    }), Finch.route("categoryData", function() {
        e().rendercategoryData();
    }), Finch.route("editData", function() {
        e().rendereditData();
    }), Finch.route("login", function() {
        t().renderLogin();
    }), Finch.route("/", function() {
        t().renderLogin();
    }), Finch.route("dashboard", function() {
        t().renderDashboard();
    }), Finch.route("forgot", function() {
        t().renderForgot();
    }), Finch.route("register", function() {
        t().renderRegister();
    }), $(document).ready(function() {
        Finch.listen();
    }), $(document).on("click", ".navigator", function(e) {
        e.preventDefault();
        var t = $(this).data("route");
        Finch.call(t);
    }), $(document).on("click", ".edit", function(e) {
        e.preventDefault();
        var t = $(this).data("route");
        a("category_id", $(this).data("id")), Finch.call(t);
    }), $(document).on("click", ".categoryData", function(e) {
        e.preventDefault();
        var t = $(this).data("route");
        a("categoryData_id", $(this).data("id")), Finch.call(t);
    }), $(document).on("click", ".editData", function(e) {
        e.preventDefault();
        var t = $(this).data("route");
        a("editData_id", $(this).data("id")), Finch.call(t);
    });
}();